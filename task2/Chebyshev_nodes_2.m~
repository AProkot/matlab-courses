
deltaCh = 1;
while deltaCh > 10e-3
    numChebNodes = numChebNodes + 1;
    if mod(numChebNodes, 20) == 0
        disp(numChebNodes)
    end
    k = cumsum(ones(1, numChebNodes));
    ChebNodes = 0.5*(a+b) + 0.5*(b-a)*cos((2*k-1)/(2*numChebNodes) * pi);
    yCh = lagrange(ChebNodes, fun(ChebNodes), xx);
    deltaCh = max(abs(yCh - yy));
end

numChebNodes = 15;
a = -1;
b = 1;
xx = linspace(a, b, 1000);
yy = fun(xx);


eqDistNodes = linspace(a, b, numChebNodes);
y_lagr = lagrange(eqDistNodes, fun(eqDistNodes), xx);

vecXX = xx.';
pow = 0:numChebNodes-1;
matrXX = vecXX.^pow;

vecC1 = linsolve(matrXX, yy');

Y1 = matrXX*vecC1;

plot(xx, yy), grid on, hold on  % clear function
plot(xx, y_lagr)  % with lagrange coefficients
plot(xx, Y1, 'Color', 'g')  % with lineq coefficients
plot(eqDistNodes, fun(eqDistNodes),'LineStyle','none','Marker','.','Color','r','MarkerSize',20)

hold off
axis([a b -2 2])